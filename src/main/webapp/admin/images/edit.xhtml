<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui">
<ui:composition template="/templates/admin.xhtml">
  <ui:define name="mainContent">
    <p:panel>
      <f:facet name="header">
        <h:outputText value="#{msg.adminImageEditHeading}" rendered="#{imageAdminBean.editing}" />
        <h:outputText value="#{msg.adminImageAddHeading}" rendered="#{!imageAdminBean.editing}" />
      </f:facet>
      <h:panelGrid styleClass="sectionControlsTable" columns="2"
        columnClasses="sectionControlsLeftColumn, sectionControlsRightColumn">
        <h:panelGroup>
          <p:commandButton value="#{msg.adminButtonsSave}" action="#{imageAdminBean.save}" ajax="false" />
          <p:button outcome="index" value="#{msg.adminButtonsCancel}" />
        </h:panelGroup>
      </h:panelGrid>
      <h:panelGrid columns="2">
        <p:outputLabel for="nameField" value="#{msg.adminImageNameField}" />
        <h:panelGroup id="nameFieldPanel">
          <p:inputText id="nameField" value="#{imageAdminBean.selected.name}" required="true"
            requiredMessage="#{msg.adminImageNameFieldRequired}" size="24">
            <p:ajax />
          </p:inputText>
          <h:message errorClass="inlineMessage ui-state-error" for="nameField" />
        </h:panelGroup>
        <p:outputLabel for="previewField" value="#{msg.adminImagePreviewField}" />
        <h:panelGroup id="previewFieldPanel">
          <h:inputHidden id="previewField" value="#{imageAdminBean.selected.extension}" required="true"
            requiredMessage="#{msg.adminImagePreviewFieldRequired}" />
          <h:outputText value="#{msg.adminImagePreviewFieldHint}" rendered="#{!imageAdminBean.fileUploaded}" />
          <p:graphicImage value="/uploads/#{imageAdminBean.selected.filename}" rendered="#{imageAdminBean.fileUploaded}" />
          <h:message errorClass="inlineMessage ui-state-error" for="previewField" />
        </h:panelGroup>
      </h:panelGrid>
      <p:fileUpload fileUploadListener="#{imageAdminBean.handleFileUpload}" mode="advanced" auto="true"
        allowTypes="/(\.|\/)(gif|jpe?g|png)$/" update="nameFieldPanel previewFieldPanel" />
    </p:panel>
  </ui:define>
</ui:composition>
</html>
